# Saverwell Deployment Playbook  
Lovable + GitHub + Hostinger + Cloudflare

This document defines the repeatable deployment process for all Saverwell / SeniorSaver projects.

---

# 0. Architecture

Development  
Lovable ↔ GitHub (two-way sync)

Production  
GitHub → Hostinger (via GitHub Actions FTPS deploy)

Security  
Cloudflare → Hostinger

Assumptions:
- Vite React app
- Build output folder = dist
- One repo per domain
- Dedicated FTP user per domain

---

# 1. Connect Lovable to GitHub

In Lovable:
1. Connect to GitHub
2. Transfer to correct org
3. Confirm:
   - Lovable edits create commits in GitHub
   - GitHub edits sync back to Lovable

GitHub is now source of truth.

---

# 2. Prepare Hostinger (Per Domain)

1. Add domain under Websites.
2. Confirm document root is:
   public_html
3. Create dedicated FTP user:
   - Directory: /public_html
   - Strong password
4. Enable SSL:
   Websites → Manage → SSL → Activate

---

# 3. Configure Cloudflare

Create DNS records:

Type: A  
Name: @  
Value: Hostinger server IP  
Proxy: DNS only (initially)

Type: CNAME  
Name: www  
Value: yourdomain.com  
Proxy: DNS only (initially)

After HTTPS works:
SSL/TLS Mode → Full (strict)

---

# 4. GitHub Deployment Workflow

Create this file:

.github/workflows/deploy.yml

COPY THIS ENTIRE BLOCK:

```yaml
name: Deploy to Hostinger

on:
  push:
    branches:
      - main

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: Install dependencies
        run: npm ci

      - name: Build
        run: npm run build

      - name: Deploy via FTPS
        uses: SamKirkland/FTP-Deploy-Action@v4.3.5
        with:
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          protocol: ftps
          port: 21
          local-dir: dist/
          server-dir: ./
```

END COPY BLOCK

Important:
Use server-dir: ./ when FTP user is scoped to public_html.

---

# 5. Add GitHub Repository Secrets

Go to:
Repo → Settings → Secrets and variables → Actions

Create these secrets:

FTP_SERVER  
FTP_USERNAME  
FTP_PASSWORD  

Each repo gets its own secrets.

---

# 6. Clean Initial Deployment

Before first deploy:

1. Open Hostinger File Manager
2. Open public_html
3. Delete everything inside
4. Leave it empty

---

# 7. Trigger Deployment

1. Commit deploy.yml
2. Push to main
3. Wait for GitHub Action to go green

After success, public_html must contain:

index.html  
assets/  
favicon files  

No nested public_html folder.

---

# 8. Add SPA Routing (React Router)

Create this file:

public_html/.htaccess

COPY THIS ENTIRE BLOCK:

```apache
RewriteEngine On
RewriteBase /
RewriteRule ^index\.html$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.html [L]
```

END COPY BLOCK

Required for client-side routing.

---

# 9. Validate Before Proxy

Run:

curl -I http://yourdomain.com  
curl -I https://yourdomain.com  

Expected:
HTTP → 301  
HTTPS → 200  

If successful:
Switch Cloudflare @ and www to Proxied.

---

# 10. Cloudflare Hardening

Enable:

Always Use HTTPS  
Auto Minify  
Brotli  
SSL Mode: Full (strict)

Keep FTP and mail DNS records as DNS only.

---

# Troubleshooting

403 on HTTPS
- Files must be directly inside public_html
- No nested public_html/public_html
- index.html must exist
- Permissions: folder 755, files 644

Duplicate Nested Folder
If deploy creates:
public_html/public_html

Change:
server-dir: public_html/
to:
server-dir: ./

Deep Links 404
.htaccess missing or incorrect.

Deploy Succeeds But No Files
Wrong server-dir or FTP user directory scope.

---

# Repeat For New Sites

For each new domain:

1. Create new repo
2. Connect Lovable
3. Create FTP user
4. Add repo secrets
5. Copy deploy.yml
6. Clean public_html
7. Deploy
8. Configure Cloudflare
